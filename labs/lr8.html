<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Лаб. работа №8: Зависимость скорости от пути</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #e74c3c;
            --bg: #f4f7f6;
            --panel: #ffffff;
            --text: #34495e;
            --radius: 8px;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            background-color: var(--bg);
            color: var(--text);
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* --- HEADER --- */
        header {
            background-color: var(--primary);
            color: white;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        h1 { margin: 0; font-size: 1.1rem; }

        .lang-switch {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.4);
            color: white;
            padding: 5px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: 0.2s;
        }
        .lang-switch:hover { background: rgba(255,255,255,0.3); }

        /* --- MAIN LAYOUT --- */
        .main-wrapper {
            display: flex;
            flex: 1;
            overflow: hidden;
            padding: 10px;
            gap: 15px;
        }

        /* SIDEBAR */
        .sidebar {
            width: 400px;
            background: var(--panel);
            border-radius: var(--radius);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border-right: 1px solid #ddd;
        }

        .tabs { display: flex; background: #ecf0f1; }
        .tab-btn {
            flex: 1; padding: 12px; border: none; background: none;
            cursor: pointer; font-weight: 600; color: #7f8c8d;
            border-bottom: 3px solid transparent;
        }
        .tab-btn.active {
            background: #fff; color: var(--primary); border-bottom-color: var(--accent);
        }

        .tab-content { padding: 20px; overflow-y: auto; flex: 1; display: none; }
        .tab-content.active { display: block; }

        /* CONTROLS */
        .control-group { margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 15px; }
        label { display: block; margin-bottom: 8px; font-weight: 600; }
        input[type="range"] { width: 100%; cursor: pointer; accent-color: var(--accent); }
        .val-display { float: right; font-weight: bold; color: var(--accent); }

        .btn {
            width: 100%; padding: 12px; border: none; border-radius: 4px;
            cursor: pointer; font-weight: bold; margin-bottom: 10px; transition: 0.2s; color: white;
        }
        .btn-start { background-color: #27ae60; } .btn-start:hover { background-color: #2ecc71; }
        .btn-record { background-color: #2980b9; } .btn-record:hover { background-color: #3498db; }
        .btn-reset { background-color: #c0392b; } .btn-reset:hover { background-color: #e74c3c; }
        .btn:disabled { background-color: #bdc3c7; cursor: not-allowed; }

        .formula-box {
            background: #eaf2f8; border-left: 4px solid #2980b9;
            padding: 10px; margin: 10px 0; font-family: monospace; text-align: center; font-size: 1.1em;
        }

        /* SIMULATION AREA */
        .sim-container {
            flex: 1;
            background: radial-gradient(circle at center, #ffffff, #f0f2f5);
            border-radius: var(--radius);
            border: 1px solid #dcdcdc;
            position: relative;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        svg { width: 100%; height: 100%; cursor: default; }

        /* SVG STYLES */
        .rail { fill: #ecf0f1; stroke: #95a5a6; stroke-width: 2; }
        .rail-top { stroke: #7f8c8d; stroke-width: 2; }
        .stopper { fill: #c0392b; stroke: #922b21; } /* Препятствие */
        .cart { fill: #34495e; stroke: #2c3e50; }
        .wheel { fill: #2c3e50; }
        .block-sensor { fill: #e74c3c; stroke: #c0392b; opacity: 0.9; } /* Брусок (бывший флажок) */
        
        .sensor-body { fill: #f1c40f; stroke: #f39c12; cursor: ew-resize; }
        .sensor-beam { stroke: #e74c3c; stroke-width: 2; stroke-dasharray: 4; opacity: 0; }
        
        .stand { fill: #bdc3c7; stroke: #7f8c8d; }
        .floor { stroke: #7f8c8d; stroke-width: 2; }

        .measure-line { stroke: #2980b9; stroke-width: 2; marker-end: url(#arrow); marker-start: url(#arrow); }
        .measure-text { fill: #2980b9; font-weight: bold; font-size: 14px; text-anchor: middle; }

        /* DIGITAL DISPLAY */
        .digital-display {
            position: absolute; top: 20px; right: 20px;
            background: #2c3e50; color: #2ecc71;
            padding: 15px; border-radius: 6px;
            font-family: 'Courier New', monospace;
            border: 2px solid #34495e;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            min-width: 180px; text-align: right;
        }
        .display-label { color: #95a5a6; font-size: 0.7rem; display: block; }
        .display-val { font-size: 1.8rem; font-weight: bold; }
        .display-sub { font-size: 0.8rem; color: #ecf0f1; border-top: 1px solid #555; margin-top: 5px; padding-top: 5px; display: flex; justify-content: space-between;}

        /* TABLE & GRAPH */
        table { width: 100%; border-collapse: collapse; font-size: 0.85rem; margin-top: 10px; }
        th, td { border: 1px solid #ddd; padding: 6px; text-align: center; }
        th { background-color: #f8f9fa; }
        
        #graph-container {
            width: 100%; height: 250px; background: white; 
            border: 1px solid #ddd; margin-top: 15px; position: relative;
        }
    </style>
</head>
<body>

<header>
    <h1 id="lab-title">Лаб. работа №8: Зависимость скорости от пройденного пути</h1>
    <button class="lang-switch" onclick="toggleLang()">RU / KZ</button>
</header>

<div class="main-wrapper">
    
    <div class="sidebar">
        <div class="tabs">
            <button class="tab-btn active" onclick="setTab('setup')" id="tab-setup">Установка</button>
            <button class="tab-btn" onclick="setTab('theory')" id="tab-theory">Теория</button>
            <button class="tab-btn" onclick="setTab('journal')" id="tab-journal">Журнал</button>
            <button class="tab-btn" onclick="setTab('graph')" id="tab-graph">График</button>
        </div>

        <div id="setup" class="tab-content active">
            <div class="control-group">
                <label id="lbl-angle">Высота подъема h (см): <span class="val-display" id="val-angle">15</span></label>
                <input type="range" id="angle-range" min="5" max="30" value="15" step="1" oninput="updateSettings()">
                <small style="color: #7f8c8d;">Регулирует наклон скамьи</small>
            </div>
            
            <div class="control-group">
                <label id="lbl-flag">Ширина бруска L (мм): <span class="val-display" id="val-flag">20</span></label>
                <input type="range" id="flag-range" min="10" max="50" value="20" step="5" oninput="updateSettings()">
            </div>

            <div class="control-group">
                <label id="lbl-dist">Путь S (м): <span class="val-display" id="val-s">0.30</span></label>
                <input type="range" id="dist-range" min="0.1" max="0.55" value="0.30" step="0.05" oninput="updateSettings()">
                <div style="font-size: 0.8rem; color: #e74c3c; margin-top: 5px;">
                    Можно двигать желтый датчик мышкой!
                </div>
            </div>

            <button class="btn btn-start" onclick="startSim()" id="btn-start">ПУСК</button>
            <button class="btn btn-record" onclick="recordData()" id="btn-record" disabled>ЗАПИСАТЬ ТОЧКУ</button>
            <button class="btn btn-reset" onclick="resetSim()" id="btn-reset">СБРОС</button>
        </div>

        <div id="theory" class="tab-content">
            <h3 id="th-goal">Цель работы</h3>
            <p id="th-goal-text">Экспериментально проверить зависимость квадрата скорости от пройденного пути при равноускоренном движении.</p>
            
            <h3 id="th-form">Основные формулы</h3>
            <p>При движении без начальной скорости (v0 = 0):</p>
            <div class="formula-box">
                v² = 2 · a · S
            </div>
            <p>Это уравнение прямой y = kx, где y=v², x=S, коэффициент k=2a.</p>
            <p><strong>Мгновенная скорость</strong> определяется по времени прохождения бруска шириной L:</p>
            <div class="formula-box">
                v = L / Δt
            </div>
        </div>

        <div id="journal" class="tab-content">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <h3 id="th-journal">Таблица данных</h3>
                <button class="btn btn-reset" style="width:auto; padding:5px 10px; font-size:0.8rem;" onclick="clearTable()">Очистить</button>
            </div>
            <div style="overflow-x: auto;">
                <table id="data-table">
                    <thead>
                        <tr>
                            <th>S (м)</th>
                            <th>Δt (с)</th>
                            <th>v (м/с)</th>
                            <th>v² (м²/с²)</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <div id="graph" class="tab-content">
            <h3>График v²(S)</h3>
            <div id="graph-container">
                <svg id="plot" width="100%" height="100%" viewBox="0 0 300 220">
                    <line x1="40" y1="190" x2="290" y2="190" stroke="#333" stroke-width="1"/> <line x1="40" y1="10" x2="40" y2="190" stroke="#333" stroke-width="1"/> <text x="280" y="210" font-size="12">S</text>
                    <text x="10" y="20" font-size="12">v²</text>
                </svg>
            </div>
            <p style="font-size:0.8rem; color:#7f8c8d;">Точки должны ложиться на прямую линию, выходящую из нуля.</p>
        </div>
    </div>

    <div class="sim-container">
        
        <div class="digital-display">
            <span class="display-label" id="disp-lbl">INSTANT VELOCITY (v)</span>
            <span class="display-val" id="disp-v">0.00</span> m/s
            <div class="display-sub">
                <span>GATE TIME (Δt):</span>
                <span id="disp-dt" style="color:#fff">0.0000 s</span>
            </div>
        </div>

        <svg id="scene" viewBox="0 0 800 500" preserveAspectRatio="xMidYMid meet">
            <defs>
                <marker id="arrow" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto">
                    <path d="M0,0 L0,10 L10,5 z" fill="#2980b9" />
                </marker>
                <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
                    <path d="M 40 0 L 0 0 0 40" fill="none" stroke="#f0f0f0" stroke-width="1"/>
                </pattern>
            </defs>
            <rect width="100%" height="100%" fill="url(#grid)" />

            <line x1="50" y1="450" x2="750" y2="450" class="floor" />

            <g id="stand-group">
                <rect x="-5" y="0" width="10" height="100" class="stand" id="stand-pole" />
                <rect x="-20" y="95" width="40" height="5" fill="#7f8c8d" /> <text x="15" y="50" font-size="14" fill="#7f8c8d" id="h-label">h</text>
            </g>

            <g id="rail-system" transform="translate(100, 450) rotate(-5)">
                <rect x="0" y="-15" width="650" height="25" class="rail" />
                <line x1="0" y1="-15" x2="650" y2="-15" class="rail-top" />
                
                <rect x="-10" y="-35" width="15" height="45" class="stopper" />

                <g id="ruler-marks"></g>

                <g id="sensor-group" transform="translate(300, 0)" style="cursor: ew-resize;" onmousedown="startDrag(evt)" ontouchstart="startDrag(evt)">
                    <path d="M-12,-45 L-12,5 L12,5 L12,-45 L8,-45 L8,-5 L-8,-5 L-8,-45 Z" class="sensor-body" />
                    <line id="beam" x1="0" y1="-35" x2="0" y2="-5" class="sensor-beam" />
                    <rect x="-20" y="-50" width="40" height="60" fill="transparent" /> 
                </g>

                <g id="cart-group" transform="translate(600, -32)">
                    <rect x="-30" y="0" width="60" height="22" class="cart" rx="4" />
                    <circle cx="-15" cy="22" r="6" class="wheel" />
                    <circle cx="15" cy="22" r="6" class="wheel" />
                    <rect id="block" x="-10" y="-18" width="20" height="18" class="block-sensor" />
                </g>

                <g transform="translate(0, 30)">
                    <line id="measure-line" x1="600" y1="0" x2="300" y2="0" class="measure-line" />
                    <text id="measure-text" x="450" y="-5" class="measure-text">S = 0.30 м</text>
                </g>
                
                <text x="600" y="25" font-size="12" fill="#7f8c8d" text-anchor="middle">СТАРТ</text>
            </g>

        </svg>
    </div>
</div>

<script>
    // === CONSTANTS ===
    const PIXELS_PER_METER = 1000; // Scale: 1m = 1000px
    const RAIL_LENGTH_PX = 650;
    const START_POS_X = 600; // Cart starts here (Right side)
    const STOP_POS_X = 35; // Position where cart hits obstacle (Cart X is center, wall is at -10 + width)
                           // Cart width 60 (center to edge 30). Wall at -10 to 5.
                           // Collision happens when Cart Left Edge hits Wall Right Edge.
                           // Cart Left Edge is (X - 30). Wall Right Edge is 5.
                           // Stop when X - 30 <= 5 => X <= 35.
    const PIVOT_X = 100;
    const PIVOT_Y = 450;
    const G = 9.81;

    // === STATE ===
    let h_cm = 15;
    let distanceS = 0.30; // meters
    let flagWidthMm = 20;
    
    let isRunning = false;
    let isDragging = false;
    
    // Results
    let measuredDt = 0;
    let measuredV = 0;

    // === DOM REFERENCES ===
    const ui = {
        rail: document.getElementById('rail-system'),
        cart: document.getElementById('cart-group'),
        block: document.getElementById('block'),
        sensor: document.getElementById('sensor-group'),
        beam: document.getElementById('beam'),
        
        standGrp: document.getElementById('stand-group'),
        standPole: document.getElementById('stand-pole'),
        hLabel: document.getElementById('h-label'),
        
        measureLine: document.getElementById('measure-line'),
        measureText: document.getElementById('measure-text'),
        
        dispV: document.getElementById('disp-v'),
        dispDt: document.getElementById('disp-dt'),
        
        svg: document.getElementById('scene'),
        plot: document.getElementById('plot'),
        
        btnStart: document.getElementById('btn-start'),
        btnRec: document.getElementById('btn-record')
    };

    // === INIT ===
    function init() {
        createRuler();
        updateSettings();
    }

    // Draw ruler on the rail (0 at START_POS_X, increasing to Left)
    function createRuler() {
        const g = document.getElementById('ruler-marks');
        // We draw ticks every 10cm (100px) from START_POS_X downwards
        // Ruler goes from Right to Left
        for(let i=0; i<=0.6; i+=0.1) {
            const x = START_POS_X - (i * PIXELS_PER_METER);
            const h = (Math.round(i*10)%5===0) ? -5 : -10; // Major/Minor ticks logic if needed
            
            const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
            line.setAttribute("x1", x); line.setAttribute("y1", -15);
            line.setAttribute("x2", x); line.setAttribute("y2", -15 + 8);
            line.setAttribute("stroke", "#95a5a6");
            line.setAttribute("stroke-width", 1);
            g.appendChild(line);
            
            const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
            text.setAttribute("x", x); text.setAttribute("y", -2);
            text.setAttribute("font-size", "10");
            text.setAttribute("fill", "#7f8c8d");
            text.setAttribute("text-anchor", "middle");
            text.textContent = (i*100).toFixed(0);
            g.appendChild(text);
        }
    }

    // === TABS ===
    function setTab(id) {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        document.getElementById('tab-' + id).classList.add('active');
        document.getElementById(id).classList.add('active');
    }

    // === UPDATE SETTINGS ===
    function updateSettings() {
        if(isRunning) return;

        h_cm = parseFloat(document.getElementById('angle-range').value);
        flagWidthMm = parseFloat(document.getElementById('flag-range').value);
        
        if(!isDragging) {
            distanceS = parseFloat(document.getElementById('dist-range').value);
        }

        // 1. Calculate Angle
        const L_rail_m = START_POS_X / PIXELS_PER_METER; // 0.6m
        const angleRad = Math.asin((h_cm/100) / L_rail_m); // h in m
        const angleDeg = angleRad * 180 / Math.PI;

        // UI Updates
        document.getElementById('val-angle').innerText = h_cm;
        document.getElementById('val-flag').innerText = flagWidthMm;
        document.getElementById('val-s').innerText = distanceS.toFixed(2);

        // 2. Rotate Rail (Negative angle for counter-clockwise, Right Up)
        ui.rail.setAttribute('transform', `translate(${PIVOT_X}, ${PIVOT_Y}) rotate(${-angleDeg})`);

        // 3. Update Stand Position (Right side)
        const railEndX = PIVOT_X + START_POS_X * Math.cos(angleRad);
        const railEndY = PIVOT_Y - START_POS_X * Math.sin(angleRad);
        
        // Stand is at railEndX. Height is (450 - railEndY).
        ui.standGrp.setAttribute('transform', `translate(${railEndX}, 0)`);
        const standH = 450 - railEndY + 20; // +20 margin
        ui.standPole.setAttribute('y', 450 - standH);
        ui.standPole.setAttribute('height', standH);
        ui.hLabel.setAttribute('y', 450 - standH/2);

        // 4. Sensor & Cart Position
        // Sensor X = Start - S_px
        const sPx = distanceS * PIXELS_PER_METER;
        const sensorX = START_POS_X - sPx;
        ui.sensor.setAttribute('transform', `translate(${sensorX}, 0)`);
        
        // Block (Flag) visual width
        // 20mm = 0.02m = 20px
        const flagPx = flagWidthMm; 
        ui.block.setAttribute('width', flagPx);
        ui.block.setAttribute('x', -flagPx/2); // Center on cart center (0)

        // Measure Line: From Start (600) to Sensor (600-S)
        ui.measureLine.setAttribute('x1', START_POS_X);
        ui.measureLine.setAttribute('x2', sensorX);
        ui.measureText.setAttribute('x', START_POS_X - sPx/2);
        ui.measureText.textContent = `S = ${distanceS.toFixed(2)} м`;

        resetSim();
    }

    function resetSim() {
        isRunning = false;
        ui.cart.setAttribute('transform', `translate(${START_POS_X}, -32)`);
        ui.dispV.innerText = "0.00";
        ui.dispDt.innerText = "0.0000 s";
        ui.beam.style.opacity = 0;
        ui.btnStart.disabled = false;
        ui.btnRec.disabled = true;
    }

    // === SIMULATION ENGINE ===
    function startSim() {
        if(isRunning) return;
        isRunning = true;
        ui.btnStart.disabled = true;

        // Calc Physics
        const L_rail_m = START_POS_X / PIXELS_PER_METER;
        const angleRad = Math.asin((h_cm/100) / L_rail_m);
        const a = G * Math.sin(angleRad);
        
        // Block (Flag) width in meters
        const L_flag_m = flagWidthMm / 1000;
        
        // Sensor Calculation Logic
        const distFrontHit = distanceS - L_flag_m/2;
        const distBackHit = distanceS + L_flag_m/2;
        
        if(distFrontHit < 0) { isRunning = false; return; }

        const t_front = Math.sqrt(2 * distFrontHit / a);
        const t_back = Math.sqrt(2 * distBackHit / a);
        
        const dt_theo = t_back - t_front;
        
        // Noise +/- 1%
        const noise = 1 + (Math.random() - 0.5) * 0.02;
        measuredDt = dt_theo * noise;
        measuredV = L_flag_m / measuredDt;
        
        // Animation
        let startTime = performance.now();
        
        // Collision time (stop time)
        // Collision happens when Cart X = STOP_POS_X (35)
        // Distance to stop = START_POS_X - STOP_POS_X
        const distToStopPx = START_POS_X - STOP_POS_X;
        const distToStopM = distToStopPx / PIXELS_PER_METER;
        const t_stop = Math.sqrt(2 * distToStopM / a);

        function animate(now) {
            const elapsed = (now - startTime) / 1000;
            
            // Limit elapsed time to stop time
            const currentTime = Math.min(elapsed, t_stop);
            
            // Distance traveled
            const distM = 0.5 * a * currentTime * currentTime;
            const distPx = distM * PIXELS_PER_METER;
            
            // Update Cart Pos (Start - dist)
            let currentX = START_POS_X - distPx;
            
            // Force stop visually if exact math drifts
            if (currentX < STOP_POS_X) currentX = STOP_POS_X;
            
            ui.cart.setAttribute('transform', `translate(${currentX}, -32)`);
            
            // Beam Logic (Only if we haven't stopped yet)
            if (currentTime < t_stop) {
                if(currentTime >= t_front && currentTime <= t_back) {
                    ui.beam.style.opacity = 1;
                    ui.dispDt.style.color = "#e74c3c";
                } else {
                    ui.beam.style.opacity = 0;
                }
            }

            // Final Value Display
            if(currentTime > t_back) {
                ui.dispDt.style.color = "#2ecc71";
                ui.dispDt.innerText = measuredDt.toFixed(4) + " s";
                ui.dispV.innerText = measuredV.toFixed(2);
            }

            // Check if hit wall
            if(elapsed >= t_stop) {
                isRunning = false;
                ui.btnStart.disabled = false;
                ui.btnRec.disabled = false;
                // Ensure opacity is off after stop
                ui.beam.style.opacity = 0;
            } else {
                requestAnimationFrame(animate);
            }
        }
        requestAnimationFrame(animate);
    }

    // === DRAG SENSOR ===
    function startDrag(evt) {
        if(isRunning) return;
        isDragging = true;
    }

    window.addEventListener('mousemove', (evt) => {
        if(!isDragging) return;
        
        const pt = ui.svg.createSVGPoint();
        pt.x = evt.clientX; pt.y = evt.clientY;
        const loc = pt.matrixTransform(ui.svg.getScreenCTM().inverse());
        
        const mouseX = loc.x;
        
        // Calculate S based on Mouse position relative to Start
        let s = ( (PIVOT_X + START_POS_X) - mouseX ) / PIXELS_PER_METER;
        
        if(s < 0.1) s = 0.1;
        if(s > 0.55) s = 0.55;
        
        document.getElementById('dist-range').value = s;
        updateSettings();
    });

    window.addEventListener('mouseup', () => isDragging = false);
    window.addEventListener('touchend', () => isDragging = false);

    // === DATA & GRAPH ===
    let points = [];

    function recordData() {
        if(measuredV === 0) return;
        
        const v2 = measuredV * measuredV;
        
        // Add to Table
        const tbody = document.getElementById('data-table').querySelector('tbody');
        const row = `<tr>
            <td>${distanceS.toFixed(2)}</td>
            <td>${measuredDt.toFixed(4)}</td>
            <td>${measuredV.toFixed(2)}</td>
            <td>${v2.toFixed(2)}</td>
        </tr>`;
        tbody.innerHTML += row;

        // Add to Graph
        points.push({x: distanceS, y: v2});
        drawGraph();
        
        ui.btnRec.disabled = true;
    }

    function clearTable() {
        document.getElementById('data-table').querySelector('tbody').innerHTML = '';
        points = [];
        drawGraph();
    }

    function drawGraph() {
        const svg = ui.plot;
        // Clean
        while(svg.lastChild.nodeName === 'circle' || svg.lastChild.nodeName === 'path') {
            svg.removeChild(svg.lastChild);
        }
        
        if(points.length === 0) return;

        // Scale
        const w = 250, h = 180;
        const x0 = 40, y0 = 190;
        
        const maxX = 0.6; 
        const maxY = Math.max(...points.map(p=>p.y)) * 1.2 || 1;

        // Trend Line (Force through 0,0)
        let sxy=0, sxx=0;
        points.forEach(p => { sxy += p.x*p.y; sxx += p.x*p.x; });
        const slope = sxy/sxx;
        
        const x2 = x0 + (0.6 / maxX) * w;
        const y2 = y0 - (slope * 0.6 / maxY) * h;

        const line = document.createElementNS("http://www.w3.org/2000/svg", "path");
        line.setAttribute("d", `M${x0},${y0} L${x2},${y2}`);
        line.setAttribute("stroke", "#e74c3c");
        line.setAttribute("stroke-width", 2);
        line.setAttribute("stroke-dasharray", "5,5");
        svg.appendChild(line);

        // Dots
        points.forEach(p => {
            const cx = x0 + (p.x / maxX) * w;
            const cy = y0 - (p.y / maxY) * h;
            const c = document.createElementNS("http://www.w3.org/2000/svg", "circle");
            c.setAttribute("cx", cx); c.setAttribute("cy", cy); 
            c.setAttribute("r", 4); c.setAttribute("fill", "#2980b9");
            svg.appendChild(c);
        });
    }

    // === LOCALIZATION ===
    let currentLang = 'ru';
    const dict = {
        ru: {
            title: "Лаб. работа №8: Зависимость скорости от пройденного пути при равноускоренном движении",
            tab1: "Установка", tab2: "Теория", tab3: "Журнал", tab4: "График",
            lblAng: "Высота подъема h (см):", lblFlag: "Ширина бруска L (мм):", lblDist: "Путь S (м):",
            btnStart: "ПУСК", btnRec: "ЗАПИСАТЬ ТОЧКУ", btnRes: "СБРОС",
            thGoal: "Цель работы", thGoalTx: "Экспериментально проверить зависимость квадрата скорости от пройденного пути при равноускоренном движении.",
            thForm: "Основные формулы",
            dispLbl: "МГНОВЕННАЯ СКОРОСТЬ (v)", dispSub: "ВРЕМЯ (Δt):",
            thS: "S (м)", thDt: "Δt (с)", thV: "v (м/с)", thV2: "v² (м²/с²)"
        },
        kz: {
            title: "Зертхана №8: Теңайнымалы қозғалыстағы жылдамдықтың жүрілген жолға тәуелділігі",
            tab1: "Қондырғы", tab2: "Теория", tab3: "Журнал", tab4: "График",
            lblAng: "Көтерілу биіктігі h (см):", lblFlag: "Білеуше ені L (мм):", lblDist: "Жол S (м):",
            btnStart: "ІСКЕ ҚОСУ", btnRec: "НҮКТЕНІ ЖАЗУ", btnRes: "ҚАЙТАРУ",
            thGoal: "Жұмыс мақсаты", thGoalTx: "Теңайнымалы қозғалыс кезіндегі жылдамдық квадратының жүрілген жолға тәуелділігін эксперимент жүзінде тексеру.",
            thForm: "Негізгі формулалар",
            dispLbl: "ЛЕЗДІК ЖЫЛДАМДЫҚ (v)", dispSub: "УАҚЫТ (Δt):",
            thS: "S (м)", thDt: "Δt (с)", thV: "v (м/с)", thV2: "v² (м²/с²)"
        }
    };

    function toggleLang() {
        currentLang = currentLang === 'ru' ? 'kz' : 'ru';
        const t = dict[currentLang];
        document.getElementById('lab-title').innerText = t.title;
        document.getElementById('tab-setup').innerText = t.tab1;
        document.getElementById('tab-theory').innerText = t.tab2;
        document.getElementById('tab-journal').innerText = t.tab3;
        document.getElementById('tab-graph').innerText = t.tab4;
        
        document.getElementById('lbl-angle').childNodes[0].nodeValue = t.lblAng + " ";
        document.getElementById('lbl-flag').childNodes[0].nodeValue = t.lblFlag + " ";
        document.getElementById('lbl-dist').childNodes[0].nodeValue = t.lblDist + " ";
        
        document.getElementById('btn-start').innerText = t.btnStart;
        document.getElementById('btn-record').innerText = t.btnRec;
        document.getElementById('btn-reset').innerText = t.btnRes;
        
        document.getElementById('th-goal').innerText = t.thGoal;
        document.getElementById('th-goal-text').innerText = t.thGoalTx;
        document.getElementById('th-form').innerText = t.thForm;
        
        document.getElementById('disp-lbl').innerText = t.dispLbl;
        document.querySelector('.display-sub span').innerText = t.dispSub;

        const ths = document.querySelectorAll('#data-table th');
        ths[0].innerText = t.thS;
        ths[1].innerText = t.thDt;
        ths[2].innerText = t.thV;
        ths[3].innerText = t.thV2;
    }

    init();

</script>
</body>
</html>